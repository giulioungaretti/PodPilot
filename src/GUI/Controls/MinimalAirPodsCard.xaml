<?xml version="1.0" encoding="utf-8"?>
<UserControl 
    x:Class="GUI.Controls.MinimalAirPodsCard" 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    
    <Border CornerRadius="12" 
            Padding="16" 
            BorderThickness="1" 
            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- Header Row -->
            <Grid Grid.Row="0" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                    <TextBlock Text="ðŸŽ§" FontSize="18" FontFamily="Segoe UI Emoji"/>
                    <TextBlock Text="{x:Bind Device.Model, Mode=OneWay}" FontWeight="SemiBold" FontSize="14"/>
                    <Ellipse Width="6" Height="6" 
                             Fill="{ThemeResource SystemFillColorSuccessBrush}" 
                             Visibility="{x:Bind Device.IsConnected, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                             ToolTipService.ToolTip="Connected"/>
                    <TextBlock Text="ðŸ”Š" FontSize="14" FontFamily="Segoe UI Emoji"
                               VerticalAlignment="Center"
                               Visibility="{x:Bind Device.IsDefaultAudioOutput, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                               ToolTipService.ToolTip="Playing audio ðŸŽ¶"/>
                </StackPanel>
                
                <Button Grid.Column="1" 
                        Command="{x:Bind Device.PrimaryActionCommand, Mode=OneWay}"
                        IsEnabled="{x:Bind Device.CanExecutePrimaryAction, Mode=OneWay}"
                        ToolTipService.ToolTip="{x:Bind Device.PrimaryButtonTooltip, Mode=OneWay}"
                        Padding="8,4">
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <ProgressRing Width="12" Height="12" 
                                      IsActive="{x:Bind Device.IsBusy, Mode=OneWay}"
                                      Visibility="{x:Bind Device.IsBusy, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        <TextBlock Text="{x:Bind Device.PrimaryButtonIcon, Mode=OneWay}" 
                                   FontSize="12" FontFamily="Segoe UI Emoji"
                                   Visibility="{x:Bind Device.IsBusy, Mode=OneWay, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                    </StackPanel>
                </Button>
            </Grid>
            
            <!-- Battery Row - Three Columns: Left, Right, Case -->
            <Grid Grid.Row="1" Margin="0,0,0,8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="8"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="8"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- Left AirPod Battery Display -->
                <Border Grid.Column="0" 
                        CornerRadius="6" 
                        Padding="8,6" 
                        Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}" 
                        Visibility="{x:Bind Device.LeftBattery, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}">
                    <StackPanel Spacing="3">
                        <TextBlock Text="L" FontWeight="SemiBold" FontSize="10" 
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   HorizontalAlignment="Center"/>
                        <StackPanel Orientation="Horizontal" Spacing="2" HorizontalAlignment="Center">
                            <FontIcon Glyph="&#xE7F3;" FontSize="8" FontFamily="Segoe MDL2 Assets"
                                      Foreground="{ThemeResource SystemFillColorSuccessBrush}"
                                      Visibility="{x:Bind Device.IsLeftInEar, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                                      ToolTipService.ToolTip="In Ear"/>
                            <FontIcon Glyph="&#xEA81;" FontSize="8" FontFamily="Segoe MDL2 Assets"
                                      Foreground="{ThemeResource SystemFillColorCautionBrush}"
                                      Visibility="{x:Bind Device.IsLeftCharging, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                                      ToolTipService.ToolTip="Charging"/>
                        </StackPanel>
                        <ProgressBar Value="{x:Bind Device.LeftBattery, Mode=OneWay, Converter={StaticResource BatteryToDoubleConverter}}"
                                     Maximum="100" Height="4" CornerRadius="2"/>
                        <TextBlock Text="{x:Bind Device.LeftBattery, Mode=OneWay, Converter={StaticResource BatteryPercentageConverter}}" 
                                   FontWeight="SemiBold" FontSize="10" HorizontalAlignment="Center"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </Border>
                
                <!-- Right AirPod Battery Display -->
                <Border Grid.Column="2" 
                        CornerRadius="6" 
                        Padding="8,6" 
                        Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}" 
                        Visibility="{x:Bind Device.RightBattery, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}">
                    <StackPanel Spacing="3">
                        <TextBlock Text="R" FontWeight="SemiBold" FontSize="10" 
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   HorizontalAlignment="Center"/>
                        <StackPanel Orientation="Horizontal" Spacing="2" HorizontalAlignment="Center">
                            <FontIcon Glyph="&#xE7F3;" FontSize="8" FontFamily="Segoe MDL2 Assets"
                                      Foreground="{ThemeResource SystemFillColorSuccessBrush}"
                                      Visibility="{x:Bind Device.IsRightInEar, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                                      ToolTipService.ToolTip="In Ear"/>
                            <FontIcon Glyph="&#xEA81;" FontSize="8" FontFamily="Segoe MDL2 Assets"
                                      Foreground="{ThemeResource SystemFillColorCautionBrush}"
                                      Visibility="{x:Bind Device.IsRightCharging, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                                      ToolTipService.ToolTip="Charging"/>
                        </StackPanel>
                        <ProgressBar Value="{x:Bind Device.RightBattery, Mode=OneWay, Converter={StaticResource BatteryToDoubleConverter}}"
                                     Maximum="100" Height="4" CornerRadius="2"/>
                        <TextBlock Text="{x:Bind Device.RightBattery, Mode=OneWay, Converter={StaticResource BatteryPercentageConverter}}" 
                                   FontWeight="SemiBold" FontSize="10" HorizontalAlignment="Center"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </Border>
                
                <!-- Case Battery Display -->
                <Border Grid.Column="4" 
                        CornerRadius="6" 
                        Padding="8,6" 
                        Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}" 
                        Visibility="{x:Bind Device.CaseBattery, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}">
                    <StackPanel Spacing="3">
                        <TextBlock Text="Case" FontWeight="SemiBold" FontSize="10" 
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   HorizontalAlignment="Center"/>
                        <StackPanel Orientation="Horizontal" Spacing="2" HorizontalAlignment="Center">
                            <FontIcon Glyph="&#xEA81;" FontSize="8" FontFamily="Segoe MDL2 Assets"
                                      Foreground="{ThemeResource SystemFillColorCautionBrush}"
                                      Visibility="{x:Bind Device.IsCaseCharging, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                                      ToolTipService.ToolTip="Charging"/>
                        </StackPanel>
                        <ProgressBar Value="{x:Bind Device.CaseBattery, Mode=OneWay, Converter={StaticResource BatteryToDoubleConverter}}"
                                     Maximum="100" Height="4" CornerRadius="2"/>
                        <TextBlock Text="{x:Bind Device.CaseBattery, Mode=OneWay, Converter={StaticResource BatteryPercentageConverter}}" 
                                   FontWeight="SemiBold" FontSize="10" HorizontalAlignment="Center"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </Border>
            </Grid>
            
            <!-- Status Row -->
            <Border Grid.Row="2" 
                    CornerRadius="6" 
                    Padding="8,4" 
                    Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}">
                <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Center">
                    <TextBlock Text="{x:Bind Device.StatusIcon, Mode=OneWay}" 
                               FontSize="12" FontFamily="Segoe UI Emoji"/>
                    <TextBlock Text="{x:Bind Device.StatusText, Mode=OneWay}" 
                               FontSize="11" 
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</UserControl>
